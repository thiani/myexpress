{"ast":null,"code":"import _objectSpread from\"C:/Users/Thiani/myexpress/myexpresslimited/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/context/CartContext.tsx\nimport React,{createContext,useState,useCallback}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const DELIVERY_FEE_THRESHOLD=5000;// Free delivery above 5000 KES\nconst DELIVERY_FEE=200;const CartContext=/*#__PURE__*/createContext(undefined);export const CartProvider=_ref=>{let{children}=_ref;const[cart,setCart]=useState({items:[],total:0,deliveryFee:0});const calculateTotals=useCallback(()=>{const subtotal=cart.items.reduce((sum,item)=>sum+item.product.price*item.quantity,0);const deliveryFee=subtotal>=DELIVERY_FEE_THRESHOLD?0:DELIVERY_FEE;const total=subtotal+deliveryFee;return{subtotal,total,deliveryFee};},[cart.items]);const addToCart=useCallback(function(product){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;setCart(prevCart=>{const existingItem=prevCart.items.find(item=>item.productId===product.id);let newItems;if(existingItem){newItems=prevCart.items.map(item=>item.productId===product.id?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+quantity}):item);}else{newItems=[...prevCart.items,{productId:product.id,quantity,product}];}const{total,deliveryFee}=calculateTotals();return{items:newItems,total,deliveryFee};});},[calculateTotals]);const removeFromCart=useCallback(productId=>{setCart(prevCart=>{const newItems=prevCart.items.filter(item=>item.productId!==productId);const{total,deliveryFee}=calculateTotals();return{items:newItems,total,deliveryFee};});},[calculateTotals]);const updateQuantity=useCallback((productId,quantity)=>{setCart(prevCart=>{const newItems=prevCart.items.map(item=>item.productId===productId?_objectSpread(_objectSpread({},item),{},{quantity:Math.max(0,quantity)}):item).filter(item=>item.quantity>0);const{total,deliveryFee}=calculateTotals();return{items:newItems,total,deliveryFee};});},[calculateTotals]);const clearCart=useCallback(()=>{setCart({items:[],total:0,deliveryFee:0});},[]);return/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart,addToCart,removeFromCart,updateQuantity,clearCart,calculateTotals},children:children});};export default CartContext;","map":{"version":3,"names":["React","createContext","useState","useCallback","jsx","_jsx","DELIVERY_FEE_THRESHOLD","DELIVERY_FEE","CartContext","undefined","CartProvider","_ref","children","cart","setCart","items","total","deliveryFee","calculateTotals","subtotal","reduce","sum","item","product","price","quantity","addToCart","arguments","length","prevCart","existingItem","find","productId","id","newItems","map","_objectSpread","removeFromCart","filter","updateQuantity","Math","max","clearCart","Provider","value"],"sources":["C:/Users/Thiani/myexpress/myexpresslimited/src/context/CartContext.tsx"],"sourcesContent":["// src/context/CartContext.tsx\r\nimport React, { createContext, useState, useCallback } from 'react';\r\nimport type { CartItem, Cart, CartContextType, CartTotals } from '../types/cart';\r\nimport type { Product } from '../types/product';\r\n\r\nconst DELIVERY_FEE_THRESHOLD = 5000; // Free delivery above 5000 KES\r\nconst DELIVERY_FEE = 200;\r\n\r\nconst CartContext = createContext<CartContextType | undefined>(undefined);\r\n\r\nexport const CartProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const [cart, setCart] = useState<Cart>({\r\n    items: [],\r\n    total: 0,\r\n    deliveryFee: 0\r\n  });\r\n\r\n  const calculateTotals = useCallback((): CartTotals => {\r\n    const subtotal = cart.items.reduce(\r\n      (sum, item) => sum + (item.product.price * item.quantity),\r\n      0\r\n    );\r\n    const deliveryFee = subtotal >= DELIVERY_FEE_THRESHOLD ? 0 : DELIVERY_FEE;\r\n    const total = subtotal + deliveryFee;\r\n\r\n    return { subtotal, total, deliveryFee };\r\n  }, [cart.items]);\r\n\r\n  const addToCart = useCallback((product: Product, quantity: number = 1) => {\r\n    setCart(prevCart => {\r\n      const existingItem = prevCart.items.find(item => item.productId === product.id);\r\n      \r\n      let newItems: CartItem[];\r\n      if (existingItem) {\r\n        newItems = prevCart.items.map(item =>\r\n          item.productId === product.id\r\n            ? { ...item, quantity: item.quantity + quantity }\r\n            : item\r\n        );\r\n      } else {\r\n        newItems = [...prevCart.items, { productId: product.id, quantity, product }];\r\n      }\r\n\r\n      const { total, deliveryFee } = calculateTotals();\r\n      \r\n      return {\r\n        items: newItems,\r\n        total,\r\n        deliveryFee\r\n      };\r\n    });\r\n  }, [calculateTotals]);\r\n\r\n  const removeFromCart = useCallback((productId: string) => {\r\n    setCart(prevCart => {\r\n      const newItems = prevCart.items.filter(item => item.productId !== productId);\r\n      const { total, deliveryFee } = calculateTotals();\r\n      \r\n      return {\r\n        items: newItems,\r\n        total,\r\n        deliveryFee\r\n      };\r\n    });\r\n  }, [calculateTotals]);\r\n\r\n  const updateQuantity = useCallback((productId: string, quantity: number) => {\r\n    setCart(prevCart => {\r\n      const newItems = prevCart.items.map(item =>\r\n        item.productId === productId\r\n          ? { ...item, quantity: Math.max(0, quantity) }\r\n          : item\r\n      ).filter(item => item.quantity > 0);\r\n\r\n      const { total, deliveryFee } = calculateTotals();\r\n\r\n      return {\r\n        items: newItems,\r\n        total,\r\n        deliveryFee\r\n      };\r\n    });\r\n  }, [calculateTotals]);\r\n\r\n  const clearCart = useCallback(() => {\r\n    setCart({ items: [], total: 0, deliveryFee: 0 });\r\n  }, []);\r\n\r\n  return (\r\n    <CartContext.Provider value={{\r\n      cart,\r\n      addToCart,\r\n      removeFromCart,\r\n      updateQuantity,\r\n      clearCart,\r\n      calculateTotals\r\n    }}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n\r\nexport default CartContext;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}